{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/store/usePlayerStore.ts"],"sourcesContent":["import { create } from 'zustand';\nimport { AudioAnalysisData } from '../hooks/useAudioAnalyzer';\n\n// 視覺主題類型\nexport type VisualizerTheme = \n  | 'abstract-geometry' \n  | 'cyberpunk-neon' \n  | 'retro-wave' \n  | 'techno-data';\n\n// 播放器狀態接口\ninterface PlayerState {\n  // 音頻文件\n  audioFile: File | null;\n  audioUrl: string | null;\n  // 播放控制\n  isPlaying: boolean;\n  volume: number;\n  currentTime: number;\n  duration: number;\n  // 音頻分析數據\n  analysisData: AudioAnalysisData | null;\n  // 視覺化主題\n  currentTheme: VisualizerTheme;\n  // 是否顯示控制面板\n  showControls: boolean;\n  // 動作\n  setAudioFile: (file: File) => void;\n  setAudioUrl: (url: string) => void;\n  clearAudio: () => void;\n  setIsPlaying: (isPlaying: boolean) => void;\n  setVolume: (volume: number) => void;\n  setCurrentTime: (time: number) => void;\n  setDuration: (duration: number) => void;\n  setAnalysisData: (data: AudioAnalysisData | null) => void;\n  setCurrentTheme: (theme: VisualizerTheme) => void;\n  toggleControls: () => void;\n}\n\n// 創建播放器狀態管理\nexport const usePlayerStore = create<PlayerState>((set) => ({\n  // 初始狀態\n  audioFile: null,\n  audioUrl: null,\n  isPlaying: false,\n  volume: 0.8,\n  currentTime: 0,\n  duration: 0,\n  analysisData: null,\n  currentTheme: 'abstract-geometry',\n  showControls: true,\n  \n  // 動作\n  setAudioFile: (file: File) => \n    set({ \n      audioFile: file, \n      audioUrl: URL.createObjectURL(file),\n      currentTime: 0,\n      isPlaying: false\n    }),\n  \n  setAudioUrl: (url: string) => \n    set({ \n      audioUrl: url, \n      audioFile: null,\n      currentTime: 0,\n      isPlaying: false\n    }),\n  \n  clearAudio: () => \n    set({ \n      audioFile: null, \n      audioUrl: null, \n      currentTime: 0, \n      duration: 0, \n      isPlaying: false \n    }),\n  \n  setIsPlaying: (isPlaying: boolean) => set({ isPlaying }),\n  \n  setVolume: (volume: number) => set({ volume }),\n  \n  setCurrentTime: (currentTime: number) => set({ currentTime }),\n  \n  setDuration: (duration: number) => set({ duration }),\n  \n  setAnalysisData: (analysisData: AudioAnalysisData | null) => set({ analysisData }),\n  \n  setCurrentTheme: (currentTheme: VisualizerTheme) => set({ currentTheme }),\n  \n  toggleControls: () => set((state) => ({ showControls: !state.showControls }))\n}));\n\nexport default usePlayerStore; "],"names":[],"mappings":";;;;AAAA;;AAwCO,MAAM,iBAAiB,CAAA,GAAA,wIAAA,CAAA,SAAM,AAAD,EAAe,CAAC,MAAQ,CAAC;QAC1D,OAAO;QACP,WAAW;QACX,UAAU;QACV,WAAW;QACX,QAAQ;QACR,aAAa;QACb,UAAU;QACV,cAAc;QACd,cAAc;QACd,cAAc;QAEd,KAAK;QACL,cAAc,CAAC,OACb,IAAI;gBACF,WAAW;gBACX,UAAU,IAAI,eAAe,CAAC;gBAC9B,aAAa;gBACb,WAAW;YACb;QAEF,aAAa,CAAC,MACZ,IAAI;gBACF,UAAU;gBACV,WAAW;gBACX,aAAa;gBACb,WAAW;YACb;QAEF,YAAY,IACV,IAAI;gBACF,WAAW;gBACX,UAAU;gBACV,aAAa;gBACb,UAAU;gBACV,WAAW;YACb;QAEF,cAAc,CAAC,YAAuB,IAAI;gBAAE;YAAU;QAEtD,WAAW,CAAC,SAAmB,IAAI;gBAAE;YAAO;QAE5C,gBAAgB,CAAC,cAAwB,IAAI;gBAAE;YAAY;QAE3D,aAAa,CAAC,WAAqB,IAAI;gBAAE;YAAS;QAElD,iBAAiB,CAAC,eAA2C,IAAI;gBAAE;YAAa;QAEhF,iBAAiB,CAAC,eAAkC,IAAI;gBAAE;YAAa;QAEvE,gBAAgB,IAAM,IAAI,CAAC,QAAU,CAAC;oBAAE,cAAc,CAAC,MAAM,YAAY;gBAAC,CAAC;IAC7E,CAAC;uCAEc","debugId":null}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/hooks/useAudioAnalyzer.ts"],"sourcesContent":["import { useRef, useState, useEffect } from 'react';\n\n// 音頻分析結果的接口\nexport interface AudioAnalysisData {\n  // FFT 數據 (頻率域)\n  frequencyData: Uint8Array;\n  // 波形數據 (時間域)\n  timeData: Uint8Array;\n  // 低中高音頻段能量\n  lowEnergy: number;\n  midEnergy: number;\n  highEnergy: number;\n  // 總體響度\n  volume: number;\n  // 峰值檢測\n  beat: boolean;\n  // 頻率平均值\n  frequencyAverage: number;\n}\n\n// 配置選項\ninterface AudioAnalyzerOptions {\n  fftSize?: number;\n  smoothingTimeConstant?: number;\n  minDecibels?: number;\n  maxDecibels?: number;\n  beatDetectionThreshold?: number;\n  beatDetectionDelay?: number;\n}\n\n// 默認配置\nconst DEFAULT_OPTIONS: AudioAnalyzerOptions = {\n  fftSize: 2048,\n  smoothingTimeConstant: 0.8,\n  minDecibels: -100,\n  maxDecibels: -30,\n  beatDetectionThreshold: 1.15,\n  beatDetectionDelay: 200,\n};\n\n/**\n * 音頻分析 Hook\n * 提供實時音頻分析功能，支持頻譜、波形和節拍檢測\n */\nexport function useAudioAnalyzer(options: AudioAnalyzerOptions = {}) {\n  // 合併用戶選項和默認選項\n  const config = { ...DEFAULT_OPTIONS, ...options };\n  \n  // 狀態和引用\n  const [isInitialized, setIsInitialized] = useState<boolean>(false);\n  const [isPlaying, setIsPlaying] = useState<boolean>(false);\n  const [audioSource, setAudioSource] = useState<string | null>(null);\n  const [analysisData, setAnalysisData] = useState<AudioAnalysisData | null>(null);\n  \n  // 引用音頻相關對象\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const audioElementRef = useRef<HTMLAudioElement | null>(null);\n  const sourceNodeRef = useRef<MediaElementAudioSourceNode | null>(null);\n  const analyzerNodeRef = useRef<AnalyserNode | null>(null);\n  const lastBeatTimeRef = useRef<number>(0);\n  const animationFrameRef = useRef<number | null>(null);\n  \n  // 初始化音頻上下文和分析器\n  const initAudioContext = () => {\n    if (isInitialized) {\n      console.log('音頻上下文已經初始化過');\n      return;\n    }\n    \n    try {\n      console.log('開始初始化音頻上下文...');\n      // 創建音頻上下文\n      // @ts-expect-error: 處理瀏覽器兼容性問題\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      \n      if (!AudioContext) {\n        console.error('瀏覽器不支持 AudioContext');\n        return;\n      }\n      \n      audioContextRef.current = new AudioContext();\n      console.log(`音頻上下文已創建，狀態: ${audioContextRef.current.state}`);\n      \n      // 創建音頻元素\n      const audioElement = new Audio();\n      audioElement.crossOrigin = 'anonymous';\n      audioElementRef.current = audioElement;\n      console.log('音頻元素已創建');\n      \n      // 創建音頻源節點\n      const sourceNode = audioContextRef.current.createMediaElementSource(audioElement);\n      sourceNodeRef.current = sourceNode;\n      console.log('音頻源節點已創建');\n      \n      // 創建分析器節點\n      const analyzerNode = audioContextRef.current.createAnalyser();\n      analyzerNode.fftSize = config.fftSize!;\n      analyzerNode.smoothingTimeConstant = config.smoothingTimeConstant!;\n      analyzerNode.minDecibels = config.minDecibels!;\n      analyzerNode.maxDecibels = config.maxDecibels!;\n      analyzerNodeRef.current = analyzerNode;\n      console.log(`分析器節點已創建，FFT大小: ${config.fftSize}`);\n      \n      // 連接節點: 源 -> 分析器 -> 輸出\n      sourceNode.connect(analyzerNode);\n      analyzerNode.connect(audioContextRef.current.destination);\n      console.log('音頻節點已連接');\n      \n      // 監聽播放狀態變化\n      audioElement.addEventListener('play', () => {\n        console.log('音頻開始播放');\n        setIsPlaying(true);\n      });\n      audioElement.addEventListener('pause', () => {\n        console.log('音頻已暫停');\n        setIsPlaying(false);\n      });\n      audioElement.addEventListener('ended', () => {\n        console.log('音頻播放完成');\n        setIsPlaying(false);\n      });\n      \n      setIsInitialized(true);\n      console.log('音頻上下文初始化完成');\n    } catch (error) {\n      console.error('初始化音頻上下文失敗:', error);\n    }\n  };\n  \n  // 分析音頻數據\n  const analyzeAudio = () => {\n    if (!analyzerNodeRef.current || !isPlaying) {\n      return;\n    }\n    \n    // 創建數據緩衝區\n    const bufferLength = analyzerNodeRef.current.frequencyBinCount;\n    const frequencyData = new Uint8Array(bufferLength);\n    const timeData = new Uint8Array(bufferLength);\n    \n    // 獲取頻率和時間域數據\n    analyzerNodeRef.current.getByteFrequencyData(frequencyData);\n    analyzerNodeRef.current.getByteTimeDomainData(timeData);\n    \n    // 計算頻段能量\n    const lowEnd = Math.floor(bufferLength * 0.1);  // 低頻 0-10%\n    const midEnd = Math.floor(bufferLength * 0.5);  // 中頻 10-50%\n    \n    let lowSum = 0;\n    let midSum = 0;\n    let highSum = 0;\n    let totalSum = 0;\n    \n    // 計算各頻段能量\n    for (let i = 0; i < bufferLength; i++) {\n      const value = frequencyData[i];\n      \n      if (i < lowEnd) {\n        lowSum += value;\n      } else if (i < midEnd) {\n        midSum += value;\n      } else {\n        highSum += value;\n      }\n      \n      totalSum += value;\n    }\n    \n    // 歸一化能量值 (0-1)\n    const lowEnergy = lowSum / (lowEnd * 255);\n    const midEnergy = midSum / ((midEnd - lowEnd) * 255);\n    const highEnergy = highSum / ((bufferLength - midEnd) * 255);\n    \n    // 總體音量 (0-1)\n    const volume = totalSum / (bufferLength * 255);\n    \n    // 頻率平均值\n    const frequencyAverage = totalSum / bufferLength;\n    \n    // 節拍檢測\n    let beat = false;\n    const now = Date.now();\n    \n    if (volume > config.beatDetectionThreshold! * 0.5 && \n        now - lastBeatTimeRef.current > config.beatDetectionDelay!) {\n      beat = true;\n      lastBeatTimeRef.current = now;\n    }\n    \n    // 更新分析數據\n    setAnalysisData({\n      frequencyData,\n      timeData,\n      lowEnergy,\n      midEnergy,\n      highEnergy,\n      volume,\n      beat,\n      frequencyAverage\n    });\n    \n    // 請求下一幀分析\n    animationFrameRef.current = requestAnimationFrame(analyzeAudio);\n  };\n  \n  // 加載並播放音頻\n  const loadAudio = (source: string | File) => {\n    console.log('loadAudio 被調用');\n    \n    // 如果未初始化，先初始化\n    if (!isInitialized) {\n      console.log('音頻上下文尚未初始化，正在初始化...');\n      initAudioContext();\n    }\n    \n    if (!audioElementRef.current) {\n      console.error('音頻元素不存在，無法加載音頻');\n      return;\n    }\n    \n    let url: string;\n    \n    if (typeof source === 'string') {\n      url = source;\n      console.log(`加載音頻URL: ${url}`);\n    } else {\n      // 處理文件對象\n      url = URL.createObjectURL(source);\n      console.log(`從文件創建Blob URL: ${url}, 文件類型: ${source.type}`);\n    }\n    \n    // 添加音頻加載事件監聽器\n    const loadStartHandler = () => console.log('音頻開始加載');\n    const loadedMetadataHandler = () => console.log('音頻元數據已加載');\n    const canPlayHandler = () => console.log('音頻可以開始播放');\n    const errorHandler = (e: Event) => console.error('音頻加載錯誤:', e);\n    \n    audioElementRef.current.addEventListener('loadstart', loadStartHandler);\n    audioElementRef.current.addEventListener('loadedmetadata', loadedMetadataHandler);\n    audioElementRef.current.addEventListener('canplay', canPlayHandler);\n    audioElementRef.current.addEventListener('error', errorHandler);\n    \n    // 設置音頻源\n    audioElementRef.current.src = url;\n    setAudioSource(url);\n    \n    // 預加載音頻\n    audioElementRef.current.load();\n    console.log('音頻加載操作已觸發');\n    \n    // 一段時間後移除事件監聽器\n    setTimeout(() => {\n      if (audioElementRef.current) {\n        audioElementRef.current.removeEventListener('loadstart', loadStartHandler);\n        audioElementRef.current.removeEventListener('loadedmetadata', loadedMetadataHandler);\n        audioElementRef.current.removeEventListener('canplay', canPlayHandler);\n        audioElementRef.current.removeEventListener('error', errorHandler);\n      }\n    }, 10000);\n  };\n  \n  // 播放音頻\n  const playAudio = async () => {\n    if (!audioElementRef.current || !audioContextRef.current) {\n      console.log('音頻元素或上下文不存在');\n      return;\n    }\n    \n    try {\n      // 添加音頻狀態調試信息\n      console.log(`音頻準備狀態: ${audioElementRef.current.readyState}, 當前源: ${audioElementRef.current.src}`);\n      console.log(`音頻上下文狀態: ${audioContextRef.current.state}`);\n      \n      // 嘗試恢復音頻上下文 (如果被暫停)\n      if (audioContextRef.current.state === 'suspended') {\n        console.log('嘗試恢復已暫停的音頻上下文...');\n        await audioContextRef.current.resume();\n        console.log('音頻上下文已恢復');\n      }\n      \n      // 檢查音頻是否已準備好\n      if (audioElementRef.current.readyState < 2) { // HAVE_CURRENT_DATA\n        console.log('等待音頻數據加載...');\n        // 等待音頻加載到足夠播放的程度\n        await new Promise<void>((resolve) => {\n          const canPlayHandler = () => {\n            console.log('音頻可以播放了');\n            audioElementRef.current?.removeEventListener('canplay', canPlayHandler);\n            resolve();\n          };\n          \n          const errorHandler = (e: Event) => {\n            console.error('音頻加載錯誤:', e);\n            audioElementRef.current?.removeEventListener('error', errorHandler);\n            resolve(); // 即使有錯誤也解析，以避免卡住\n          };\n          \n          audioElementRef.current!.addEventListener('canplay', canPlayHandler);\n          audioElementRef.current!.addEventListener('error', errorHandler);\n          \n          // 添加超時，避免無限等待\n          setTimeout(() => {\n            console.log('音頻加載超時');\n            audioElementRef.current?.removeEventListener('canplay', canPlayHandler);\n            audioElementRef.current?.removeEventListener('error', errorHandler);\n            resolve();\n          }, 5000); // 5秒超時\n        });\n      }\n      \n      // 再次檢查音頻元素\n      if (!audioElementRef.current) {\n        console.log('音頻元素已被釋放');\n        return;\n      }\n      \n      // 如果音頻已暫停或未播放，則嘗試播放\n      if (audioElementRef.current.paused) {\n        console.log('嘗試播放音頻...');\n        // 播放\n        await audioElementRef.current.play();\n        console.log('音頻播放中');\n        \n        // 確保音量已經設置\n        if (audioElementRef.current.volume === 0) {\n          audioElementRef.current.volume = 0.8; // 默認音量\n        }\n        \n        // 開始分析\n        cancelAnimationFrame(animationFrameRef.current!);\n        analyzeAudio();\n      } else {\n        console.log('音頻已經在播放中');\n      }\n    } catch (error) {\n      // 處理AbortError (播放請求被中斷)\n      if (error instanceof Error) {\n        if (error.name === 'AbortError') {\n          console.log('播放請求被中斷，可能是新音頻正在加載');\n        } else if (error.name === 'NotAllowedError') {\n          console.error('播放被瀏覽器阻止。需要用戶交互才能播放音頻。');\n          // 可以在這裡添加用戶提示\n        } else {\n          // 其他錯誤\n          console.error('播放音頻時發生錯誤:', error);\n        }\n      } else {\n        console.error('未知錯誤:', error);\n      }\n    }\n  };\n  \n  // 暫停音頻\n  const pauseAudio = () => {\n    if (!audioElementRef.current) return;\n    audioElementRef.current.pause();\n    \n    // 停止分析\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n  };\n  \n  // 清理函數\n  useEffect(() => {\n    return () => {\n      // 停止播放\n      if (audioElementRef.current) {\n        audioElementRef.current.pause();\n      }\n      \n      // 取消動畫幀\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      \n      // 釋放 URL 對象\n      if (audioSource && audioSource.startsWith('blob:')) {\n        URL.revokeObjectURL(audioSource);\n      }\n      \n      // 斷開節點連接\n      if (sourceNodeRef.current && analyzerNodeRef.current) {\n        sourceNodeRef.current.disconnect();\n        analyzerNodeRef.current.disconnect();\n      }\n      \n      // 關閉音頻上下文\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, [audioSource]);\n  \n  return {\n    isInitialized,\n    isPlaying,\n    analysisData,\n    loadAudio,\n    playAudio,\n    pauseAudio,\n    audioElement: audioElementRef.current\n  };\n}\n\nexport default useAudioAnalyzer; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 411, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/ui/AudioPlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef } from 'react';\nimport { usePlayerStore } from '../../store/usePlayerStore';\nimport { useAudioAnalyzer } from '../../hooks/useAudioAnalyzer';\nimport { motion } from 'framer-motion';\n\n// 格式化時間 (秒 -> mm:ss)\nconst formatTime = (seconds: number): string => {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n};\n\nexport default function AudioPlayer() {\n  // 文件上傳 ref\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // 播放器狀態\n  const {\n    audioFile, \n    audioUrl,\n    isPlaying,\n    volume,\n    currentTime,\n    duration,\n    setIsPlaying,\n    setCurrentTime,\n    setDuration,\n    setAnalysisData,\n    setAudioFile\n  } = usePlayerStore();\n  \n  // 音頻分析器 hook\n  const { \n    loadAudio, \n    playAudio, \n    pauseAudio, \n    analysisData,\n    audioElement \n  } = useAudioAnalyzer({\n    fftSize: 2048,\n    beatDetectionThreshold: 1.2\n  });\n  \n  // 使用ref來追蹤上次更新時間，用於限制更新頻率\n  const lastUpdateTimeRef = useRef(0);\n  \n  // 進度更新\n  useEffect(() => {\n    if (!audioElement) return;\n    \n    // 設置音量\n    audioElement.volume = volume;\n    \n    // 時間更新事件\n    const handleTimeUpdate = () => {\n      setCurrentTime(audioElement.currentTime);\n    };\n    \n    // 持續時間變更事件\n    const handleDurationChange = () => {\n      setDuration(audioElement.duration || 0);\n    };\n    \n    // 添加事件監聽\n    audioElement.addEventListener('timeupdate', handleTimeUpdate);\n    audioElement.addEventListener('durationchange', handleDurationChange);\n    \n    return () => {\n      // 移除事件監聽\n      audioElement.removeEventListener('timeupdate', handleTimeUpdate);\n      audioElement.removeEventListener('durationchange', handleDurationChange);\n    };\n  }, [audioElement, setCurrentTime, setDuration, volume]);\n  \n  // 更新分析數據 (使用節流來減少更新頻率)\n  useEffect(() => {\n    if (analysisData) {\n      const now = Date.now();\n      // 每50ms最多更新一次，減少不必要的狀態更新\n      if (now - lastUpdateTimeRef.current > 50) {\n        setAnalysisData(analysisData);\n        lastUpdateTimeRef.current = now;\n      }\n    }\n  }, [analysisData, setAnalysisData]);\n  \n  // 處理文件上傳\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n    \n    const file = files[0];\n    \n    // 檢查文件類型\n    if (!file.type.startsWith('audio/')) {\n      alert('請上傳有效的音頻文件');\n      return;\n    }\n    \n    console.log(`正在處理上傳的文件: ${file.name}, 類型: ${file.type}, 大小: ${file.size} 字節`);\n    \n    // 如果當前正在播放，先停止播放\n    if (isPlaying) {\n      setIsPlaying(false);\n    }\n    \n    // 延遲一下再設置新文件，確保先前的播放已停止\n    setTimeout(() => {\n      // 設置音頻文件\n      setAudioFile(file);\n      console.log(`文件已設置: ${file.name}`);\n    }, 100);\n  };\n  \n  // 處理播放/暫停點擊\n  const handlePlayPause = () => {\n    if (!audioUrl) {\n      console.log('沒有可播放的音頻文件');\n      return;\n    }\n    \n    console.log(`切換播放狀態: ${!isPlaying ? '播放' : '暫停'}`);\n    setIsPlaying(!isPlaying);\n  };\n  \n  // 處理上傳按鈕點擊\n  const handleUploadClick = () => {\n    if (fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  };\n  \n  // 處理滑塊變化\n  const handleSeek = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newTime = parseFloat(e.target.value);\n    if (audioElement) {\n      audioElement.currentTime = newTime;\n      setCurrentTime(newTime);\n    }\n  };\n  \n  // 加載音頻文件\n  useEffect(() => {\n    if (audioUrl) {\n      console.log(`準備加載音頻: ${audioUrl}`);\n      // 確保先停止之前的播放\n      pauseAudio();\n      // 延遲加載，避免冲突\n      const loadTimer = setTimeout(() => {\n        console.log(`加載音頻: ${audioUrl}`);\n        loadAudio(audioUrl);\n      }, 300); // 增加延時以確保前一個操作完成\n      \n      return () => clearTimeout(loadTimer);\n    }\n  }, [audioUrl, loadAudio, pauseAudio]);\n  \n  // 自動播放\n  useEffect(() => {\n    // 當音頻加載完成後自動播放一次\n    if (audioUrl && duration > 0 && !isPlaying) {\n      console.log('音頻已加載完成，嘗試自動播放');\n      setIsPlaying(true);\n    }\n  }, [audioUrl, duration, isPlaying, setIsPlaying]);\n  \n  // 播放/暫停控制\n  useEffect(() => {\n    if (isPlaying) {\n      console.log('播放控制: 播放');\n      playAudio();\n    } else {\n      console.log('播放控制: 暫停');\n      pauseAudio();\n    }\n  }, [isPlaying, playAudio, pauseAudio]);\n  \n  return (\n    <motion.div \n      className=\"player-container w-full max-w-3xl p-5 text-white\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5 }}\n    >\n      {/* 隱藏的文件輸入 */}\n      <input \n        type=\"file\" \n        ref={fileInputRef} \n        onChange={handleFileUpload} \n        accept=\"audio/*\" \n        className=\"hidden\"\n      />\n      \n      {/* 上傳按鈕和標題 */}\n      <div className=\"flex justify-between items-center mb-5\">\n        <div className=\"flex flex-col\">\n          <h2 className=\"text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-blue-400\">\n            {audioFile ? audioFile.name.length > 30 \n              ? audioFile.name.substring(0, 30) + '...' \n              : audioFile.name \n              : '無音樂文件'}\n          </h2>\n          {audioFile && (\n            <span className=\"text-xs text-gray-400 mt-1\">\n              {audioFile.type.replace('audio/', '')} · {Math.round(audioFile.size / 1024)} KB\n            </span>\n          )}\n        </div>\n        <motion.button \n          onClick={handleUploadClick}\n          className=\"btn-glow px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-full text-sm font-medium shadow-lg hover:shadow-purple-600/20\"\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.98 }}\n        >\n          <div className=\"flex items-center\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n            </svg>\n            上傳音頻\n          </div>\n        </motion.button>\n      </div>\n      \n      {/* 頻譜預覽 (簡單版) */}\n      <div className=\"mb-5 relative\">\n        <div className=\"h-16 w-full flex items-end gap-0.5 rounded-lg overflow-hidden bg-black/20 backdrop-blur-sm p-1\">\n          {analysisData ? (\n            Array.from({ length: 64 }).map((_, i) => {\n              // 從頻譜數據中抽樣\n              const index = Math.floor(i * (analysisData.frequencyData.length / 64));\n              const value = analysisData.frequencyData[index] / 255;\n              \n              return (\n                <motion.div \n                  key={i}\n                  className={`flex-1 rounded-t ${i % 2 === 0 ? 'bg-gradient-to-t from-indigo-600 to-purple-500' : 'bg-gradient-to-t from-blue-600 to-indigo-500'}`}\n                  style={{ \n                    height: `${Math.max(5, value * 100)}%`,\n                    animationDelay: `${i * 0.01}s` \n                  }}\n                  initial={{ height: '5%' }}\n                  animate={{ height: `${Math.max(5, value * 100)}%` }}\n                  transition={{ duration: 0.1 }}\n                />\n              );\n            })\n          ) : (\n            <div className=\"w-full h-full flex justify-center items-center text-xs text-gray-400\">\n              等待音頻...\n            </div>\n          )}\n        </div>\n\n        {/* 音頻能量指標 */}\n        {analysisData && (\n          <div className=\"absolute top-2 right-3 flex gap-2 text-xs\">\n            <span className=\"px-2 py-1 rounded-full bg-black/30 text-blue-300\">\n              低頻: {Math.round(analysisData.lowEnergy * 100)}%\n            </span>\n            <span className=\"px-2 py-1 rounded-full bg-black/30 text-indigo-300\">\n              中頻: {Math.round(analysisData.midEnergy * 100)}%\n            </span>\n            <span className=\"px-2 py-1 rounded-full bg-black/30 text-purple-300\">\n              高頻: {Math.round(analysisData.highEnergy * 100)}%\n            </span>\n          </div>\n        )}\n      </div>\n      \n      {/* 進度條 */}\n      <div className=\"mb-4\">\n        <input \n          type=\"range\"\n          min={0}\n          max={duration || 100}\n          value={currentTime}\n          onChange={handleSeek}\n          className=\"w-full\"\n          style={{\n            backgroundSize: `${(currentTime / (duration || 1)) * 100}% 100%`,\n            backgroundImage: 'linear-gradient(to right, #8b5cf6, #3b82f6)'\n          }}\n        />\n        <div className=\"flex justify-between text-xs text-gray-300 mt-1 px-1\">\n          <span>{formatTime(currentTime)}</span>\n          <span>{formatTime(duration)}</span>\n        </div>\n      </div>\n      \n      {/* 控制按鈕 */}\n      <div className=\"flex justify-center items-center\">\n        <motion.button \n          onClick={handlePlayPause}\n          disabled={!audioUrl}\n          whileHover={{ scale: 1.1 }}\n          whileTap={{ scale: 0.95 }}\n          className={`\n            w-14 h-14 rounded-full flex items-center justify-center shadow-xl\n            ${audioUrl \n              ? 'bg-gradient-to-br from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700' \n              : 'bg-gray-700/50 cursor-not-allowed'\n            }\n            transition-all duration-300\n          `}\n        >\n          {isPlaying ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <rect x=\"6\" y=\"4\" width=\"4\" height=\"16\"></rect>\n              <rect x=\"14\" y=\"4\" width=\"4\" height=\"16\"></rect>\n            </svg>\n          ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <polygon points=\"5 3 19 12 5 21 5 3\"></polygon>\n            </svg>\n          )}\n        </motion.button>\n        \n        {/* 節拍指示器 */}\n        {analysisData && analysisData.beat && (\n          <motion.div \n            className=\"absolute w-24 h-24 rounded-full\"\n            initial={{ opacity: 0.8, scale: 0.8 }}\n            animate={{ opacity: 0, scale: 1.5 }}\n            transition={{ duration: 0.4 }}\n            style={{ \n              background: 'radial-gradient(circle, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0) 70%)'\n            }}\n          />\n        )}\n      </div>\n      \n      {/* 音量條 (小螢幕隱藏) */}\n      <div className=\"mt-4 hidden sm:flex items-center justify-center gap-2\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"text-gray-400\">\n          <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"></polygon>\n          <path d=\"M15.54 8.46a5 5 0 0 1 0 7.07\"></path>\n          <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14\"></path>\n        </svg>\n        <input \n          type=\"range\"\n          min={0}\n          max={1}\n          step={0.01}\n          value={volume}\n          onChange={(e) => audioElement && (audioElement.volume = parseFloat(e.target.value))}\n          className=\"w-24\"\n          style={{\n            backgroundSize: `${volume * 100}% 100%`,\n            backgroundImage: 'linear-gradient(to right, #8b5cf6, #3b82f6)'\n          }}\n        />\n      </div>\n    </motion.div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1011, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/ui/ThemeSwitcher.tsx"],"sourcesContent":["'use client';\n\nimport { motion } from 'framer-motion';\nimport { usePlayerStore } from '../../store/usePlayerStore';\nimport type { VisualizerTheme } from '../../store/usePlayerStore';\n\n// 主題選項配置\nconst THEMES = [\n  {\n    id: 'abstract-geometry',\n    name: '幾何抽象',\n    description: '極簡線條與幾何圖形',\n    color: 'from-indigo-500 to-purple-600',\n    icon: (\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-6 h-6\">\n        <polygon points=\"12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2\"></polygon>\n        <line x1=\"12\" y1=\"22\" x2=\"12\" y2=\"15.5\"></line>\n        <polyline points=\"22 8.5 12 15.5 2 8.5\"></polyline>\n      </svg>\n    ),\n  },\n  {\n    id: 'cyberpunk-neon',\n    name: '賽博朋克',\n    description: '霓虹燈與未來感',\n    color: 'from-pink-500 to-cyan-400',\n    icon: (\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-6 h-6\">\n        <path d=\"M5.67 19.74A7.97 7.97 0 0 0 12 22a7.97 7.97 0 0 0 6.33-2.26c.88-.83.67-2.27-.42-2.83L12 13l-5.91 3.91c-1.09.56-1.3 2-.42 2.83Z\"></path>\n        <path d=\"M19.14 4.93A7.97 7.97 0 0 0 12 2a7.97 7.97 0 0 0-7.14 2.93c-.85.86-.64 2.28.43 2.85L12 11l6.71-3.22c1.07-.57 1.28-1.99.43-2.85Z\"></path>\n      </svg>\n    ),\n  },\n  {\n    id: 'retro-wave',\n    name: '復古波浪',\n    description: '80年代復古風格',\n    color: 'from-rose-500 to-indigo-700',\n    icon: (\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-6 h-6\">\n        <path d=\"m8 2 10 20\"></path>\n        <path d=\"M18 2 8 22\"></path>\n        <path d=\"M2 12h20\"></path>\n      </svg>\n    ),\n  },\n  {\n    id: 'techno-data',\n    name: '科技數據',\n    description: '數據驅動可視化',\n    color: 'from-emerald-500 to-cyan-500',\n    icon: (\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-6 h-6\">\n        <path d=\"M10 2v7.31\"></path>\n        <path d=\"M14 9.3V1.99\"></path>\n        <path d=\"M8.5 2h7\"></path>\n        <path d=\"M14 9.3a6 6 0 1 1-4 0\"></path>\n        <path d=\"M5.58 16.5h12.85\"></path>\n      </svg>\n    ),\n  }\n];\n\nexport default function ThemeSwitcher() {\n  const { currentTheme, setCurrentTheme } = usePlayerStore();\n  \n  return (\n    <motion.div \n      className=\"theme-selector\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5, delay: 0.2 }}\n    >\n      <div className=\"p-4 pb-2 flex justify-between items-center\">\n        <h3 className=\"text-base font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-blue-400\">視覺主題風格</h3>\n        <span className=\"text-xs text-gray-400\">4種風格</span>\n      </div>\n      \n      <div className=\"px-3 pb-4\">\n        <div className=\"grid grid-cols-2 gap-2\">\n          {THEMES.map((theme) => {\n            const isActive = currentTheme === theme.id;\n            \n            return (\n              <motion.button\n                key={theme.id}\n                onClick={() => setCurrentTheme(theme.id as VisualizerTheme)}\n                className={`\n                  theme-button relative rounded-lg p-3\n                  ${isActive \n                    ? 'bg-gradient-to-br ' + theme.color + ' shadow-lg' \n                    : 'bg-black/20 hover:bg-black/30'\n                  }\n                `}\n                whileHover={{ scale: 1.03 }}\n                whileTap={{ scale: 0.97 }}\n              >\n                <div className=\"flex flex-col items-center\">\n                  <div className={`mb-1.5 ${isActive ? 'text-white' : 'text-gray-300'}`}>\n                    {theme.icon}\n                  </div>\n                  <span className={`text-sm font-medium ${isActive ? 'text-white' : 'text-gray-300'}`}>\n                    {theme.name}\n                  </span>\n                  <span className={`text-xs mt-0.5 ${isActive ? 'text-white/80' : 'text-gray-500'}`}>\n                    {theme.description}\n                  </span>\n                  \n                  {isActive && (\n                    <motion.div \n                      className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-white\"\n                      initial={{ scale: 0 }}\n                      animate={{ scale: 1 }}\n                      layoutId=\"activeIndicator\"\n                    />\n                  )}\n                </div>\n                \n                {isActive && (\n                  <motion.div \n                    className=\"absolute inset-0 rounded-lg\"\n                    initial={{ opacity: 0 }}\n                    animate={{ \n                      opacity: [0.3, 0.1, 0.3], \n                      boxShadow: [\n                        `0 0 0 1px rgba(255, 255, 255, 0.1)`,\n                        `0 0 0 3px rgba(255, 255, 255, 0.05)`,\n                        `0 0 0 1px rgba(255, 255, 255, 0.1)`\n                      ]\n                    }}\n                    transition={{ \n                      repeat: Infinity,\n                      duration: 3,\n                      ease: \"easeInOut\" \n                    }}\n                  />\n                )}\n              </motion.button>\n            );\n          })}\n        </div>\n        \n        <div className=\"mt-4 text-center\">\n          <span className=\"text-xs text-gray-400 inline-flex items-center\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"mr-1\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n              <polyline points=\"12 6 12 12 16 14\"></polyline>\n            </svg>\n            視覺效果會隨著音樂節奏而變化\n          </span>\n        </div>\n      </div>\n    </motion.div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1424, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/visualizers/themes/AbstractGeometry.tsx"],"sourcesContent":["'use client';\n\nimport { useRef, useEffect } from 'react';\nimport { Canvas, useFrame } from '@react-three/fiber';\nimport { OrbitControls, Icosahedron, Torus, TorusKnot } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { AudioAnalysisData } from '../../../hooks/useAudioAnalyzer';\n\n// 粒子系統\nfunction ParticleSystem({ \n  count = 300, \n  lowEnergy, \n  midEnergy \n}: { \n  count?: number, \n  lowEnergy: number, \n  midEnergy: number, \n  highEnergy?: number  // 可選參數\n}) {\n  const meshRef = useRef<THREE.Points>(null);\n  const geometryRef = useRef<THREE.BufferGeometry>(null);\n  \n  // 初始化粒子系統\n  useEffect(() => {\n    if (!geometryRef.current) return;\n    \n    const positions = new Float32Array(count * 3);\n    const colors = new Float32Array(count * 3);\n    const sizes = new Float32Array(count);\n    \n    for (let i = 0; i < count; i++) {\n      // 位置\n      const theta = Math.random() * Math.PI * 2;\n      const radius = 5 + Math.random() * 10;\n      \n      positions[i * 3] = radius * Math.sin(theta); // x\n      positions[i * 3 + 1] = (Math.random() - 0.5) * 10; // y\n      positions[i * 3 + 2] = radius * Math.cos(theta); // z\n      \n      // 隨機顏色：藍紫色調\n      colors[i * 3] = 0.3 + Math.random() * 0.2; // r\n      colors[i * 3 + 1] = 0.2 + Math.random() * 0.3; // g\n      colors[i * 3 + 2] = 0.8 + Math.random() * 0.2; // b\n      \n      // 尺寸\n      sizes[i] = 0.5 + Math.random();\n    }\n    \n    geometryRef.current.setAttribute('position', new THREE.BufferAttribute(positions, 3));\n    geometryRef.current.setAttribute('color', new THREE.BufferAttribute(colors, 3));\n    geometryRef.current.setAttribute('size', new THREE.BufferAttribute(sizes, 1));\n  }, [count]);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!meshRef.current || !geometryRef.current) return;\n    \n    // 確保屬性存在\n    if (!geometryRef.current.attributes.position || \n        !geometryRef.current.attributes.size || \n        !geometryRef.current.attributes.position.array || \n        !geometryRef.current.attributes.size.array) {\n      return;\n    }\n    \n    // 獲取當前粒子位置\n    const positions = geometryRef.current.attributes.position.array as Float32Array;\n    const sizes = geometryRef.current.attributes.size.array as Float32Array;\n    \n    // 更新粒子位置和大小\n    for (let i = 0; i < count; i++) {\n      // 使用低頻能量擴散粒子\n      const spreadFactor = lowEnergy * 2;\n      \n      // 位置增量\n      positions[i * 3] += Math.sin(i) * delta * spreadFactor;\n      positions[i * 3 + 1] += Math.cos(i) * delta * spreadFactor;\n      positions[i * 3 + 2] += Math.sin(i * 0.1) * delta * spreadFactor;\n      \n      // 更新尺寸，由中頻控制\n      sizes[i] = (0.5 + Math.random()) * (1 + midEnergy * 3);\n    }\n    \n    // 更新幾何體\n    geometryRef.current.attributes.position.needsUpdate = true;\n    geometryRef.current.attributes.size.needsUpdate = true;\n    \n    // 旋轉粒子系統\n    meshRef.current.rotation.y += delta * 0.05 * (1 + lowEnergy);\n  });\n  \n  return (\n    <points ref={meshRef}>\n      <bufferGeometry ref={geometryRef} />\n      <pointsMaterial \n        size={1.5}\n        vertexColors\n        transparent\n        blending={THREE.AdditiveBlending}\n        depthWrite={false}\n      />\n    </points>\n  );\n}\n\n// 中央幾何體\nfunction CentralGeometry({ \n  beat, \n  lowEnergy, \n  midEnergy, \n  highEnergy \n}: { \n  beat: boolean, \n  lowEnergy: number, \n  midEnergy: number, \n  highEnergy: number \n}) {\n  const icosaRef = useRef<THREE.Mesh>(null);\n  const torusRef = useRef<THREE.Mesh>(null);\n  const knotRef = useRef<THREE.Mesh>(null);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!icosaRef.current || !torusRef.current || !knotRef.current) return;\n    \n    // 節拍觸發動畫\n    if (beat) {\n      icosaRef.current.scale.set(\n        1 + highEnergy * 0.5,\n        1 + highEnergy * 0.5,\n        1 + highEnergy * 0.5\n      );\n    } else {\n      // 緩慢恢復原大小\n      icosaRef.current.scale.x = THREE.MathUtils.lerp(icosaRef.current.scale.x, 1, delta * 2);\n      icosaRef.current.scale.y = THREE.MathUtils.lerp(icosaRef.current.scale.y, 1, delta * 2);\n      icosaRef.current.scale.z = THREE.MathUtils.lerp(icosaRef.current.scale.z, 1, delta * 2);\n    }\n    \n    // 旋轉\n    icosaRef.current.rotation.x += delta * 0.2 * (1 + midEnergy);\n    icosaRef.current.rotation.y += delta * 0.3 * (1 + midEnergy);\n    \n    torusRef.current.rotation.x += delta * 0.3 * (1 + lowEnergy);\n    torusRef.current.rotation.y += delta * 0.2 * (1 + lowEnergy);\n    \n    knotRef.current.rotation.x -= delta * 0.2 * (1 + highEnergy);\n    knotRef.current.rotation.z -= delta * 0.3 * (1 + highEnergy);\n  });\n  \n  return (\n    <group>\n      <Icosahedron ref={icosaRef} args={[1, 1]} position={[0, 0, 0]}>\n        <meshBasicMaterial \n          wireframe \n          color=\"#8b5cf6\"\n        />\n      </Icosahedron>\n      \n      <Torus ref={torusRef} args={[2, 0.2, 16, 50]} position={[0, 0, 0]}>\n        <meshBasicMaterial \n          wireframe \n          color=\"#6366f1\"\n        />\n      </Torus>\n      \n      <TorusKnot ref={knotRef} args={[1.5, 0.1, 128, 32]} position={[0, 0, 0]}>\n        <meshBasicMaterial \n          wireframe \n          color=\"#3b82f6\"\n        />\n      </TorusKnot>\n    </group>\n  );\n}\n\n// 場景容器\nfunction Scene({ analysisData }: { analysisData: AudioAnalysisData }) {\n  // 添加數據驗證，確保所有必要的屬性都存在\n  const validData = analysisData && \n    typeof analysisData.lowEnergy === 'number' && \n    typeof analysisData.midEnergy === 'number' && \n    typeof analysisData.highEnergy === 'number' && \n    typeof analysisData.beat === 'boolean' &&\n    analysisData.frequencyData instanceof Uint8Array;\n  \n  // 如果數據無效，提供默認值\n  const safeData = validData ? analysisData : {\n    lowEnergy: 0,\n    midEnergy: 0,\n    highEnergy: 0,\n    beat: false,\n    frequencyData: new Uint8Array(1024).fill(0)\n  };\n  \n  return (\n    <>\n      <ambientLight intensity={0.5} />\n      <ParticleSystem \n        count={300}\n        lowEnergy={safeData.lowEnergy}\n        midEnergy={safeData.midEnergy}\n      />\n      <CentralGeometry \n        beat={safeData.beat}\n        lowEnergy={safeData.lowEnergy}\n        midEnergy={safeData.midEnergy}\n        highEnergy={safeData.highEnergy}\n      />\n      <OrbitControls enableZoom={false} enablePan={false} autoRotate autoRotateSpeed={0.5} />\n    </>\n  );\n}\n\n// 抽象幾何可視化主題\nexport default function AbstractGeometry({ analysisData }: { analysisData: AudioAnalysisData }) {\n  return (\n    <Canvas \n      className=\"w-full h-full\"\n      camera={{ position: [0, 0, 15], fov: 60 }}\n      style={{\n        background: 'radial-gradient(circle at center, #1e1b4b 0%, #030712 100%)'\n      }}\n    >\n      <Scene analysisData={analysisData} />\n    </Canvas>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AAAA;AACA;AALA;;;;;;AAQA,OAAO;AACP,SAAS,eAAe,EACtB,QAAQ,GAAG,EACX,SAAS,EACT,SAAS,EAMV;IACC,MAAM,UAAU,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAgB;IACrC,MAAM,cAAc,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAwB;IAEjD,UAAU;IACV,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,CAAC,YAAY,OAAO,EAAE;QAE1B,MAAM,YAAY,IAAI,aAAa,QAAQ;QAC3C,MAAM,SAAS,IAAI,aAAa,QAAQ;QACxC,MAAM,QAAQ,IAAI,aAAa;QAE/B,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,IAAK;YAC9B,KAAK;YACL,MAAM,QAAQ,KAAK,MAAM,KAAK,KAAK,EAAE,GAAG;YACxC,MAAM,SAAS,IAAI,KAAK,MAAM,KAAK;YAEnC,SAAS,CAAC,IAAI,EAAE,GAAG,SAAS,KAAK,GAAG,CAAC,QAAQ,IAAI;YACjD,SAAS,CAAC,IAAI,IAAI,EAAE,GAAG,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI,IAAI,IAAI;YACvD,SAAS,CAAC,IAAI,IAAI,EAAE,GAAG,SAAS,KAAK,GAAG,CAAC,QAAQ,IAAI;YAErD,YAAY;YACZ,MAAM,CAAC,IAAI,EAAE,GAAG,MAAM,KAAK,MAAM,KAAK,KAAK,IAAI;YAC/C,MAAM,CAAC,IAAI,IAAI,EAAE,GAAG,MAAM,KAAK,MAAM,KAAK,KAAK,IAAI;YACnD,MAAM,CAAC,IAAI,IAAI,EAAE,GAAG,MAAM,KAAK,MAAM,KAAK,KAAK,IAAI;YAEnD,KAAK;YACL,KAAK,CAAC,EAAE,GAAG,MAAM,KAAK,MAAM;QAC9B;QAEA,YAAY,OAAO,CAAC,YAAY,CAAC,YAAY,IAAI,+IAAA,CAAA,kBAAqB,CAAC,WAAW;QAClF,YAAY,OAAO,CAAC,YAAY,CAAC,SAAS,IAAI,+IAAA,CAAA,kBAAqB,CAAC,QAAQ;QAC5E,YAAY,OAAO,CAAC,YAAY,CAAC,QAAQ,IAAI,+IAAA,CAAA,kBAAqB,CAAC,OAAO;IAC5E,GAAG;QAAC;KAAM;IAEV,KAAK;IACL,CAAA,GAAA,+MAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,QAAQ;QAChB,IAAI,CAAC,QAAQ,OAAO,IAAI,CAAC,YAAY,OAAO,EAAE;QAE9C,SAAS;QACT,IAAI,CAAC,YAAY,OAAO,CAAC,UAAU,CAAC,QAAQ,IACxC,CAAC,YAAY,OAAO,CAAC,UAAU,CAAC,IAAI,IACpC,CAAC,YAAY,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAK,IAC9C,CAAC,YAAY,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,EAAE;YAC9C;QACF;QAEA,WAAW;QACX,MAAM,YAAY,YAAY,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAK;QAC/D,MAAM,QAAQ,YAAY,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK;QAEvD,YAAY;QACZ,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,IAAK;YAC9B,aAAa;YACb,MAAM,eAAe,YAAY;YAEjC,OAAO;YACP,SAAS,CAAC,IAAI,EAAE,IAAI,KAAK,GAAG,CAAC,KAAK,QAAQ;YAC1C,SAAS,CAAC,IAAI,IAAI,EAAE,IAAI,KAAK,GAAG,CAAC,KAAK,QAAQ;YAC9C,SAAS,CAAC,IAAI,IAAI,EAAE,IAAI,KAAK,GAAG,CAAC,IAAI,OAAO,QAAQ;YAEpD,aAAa;YACb,KAAK,CAAC,EAAE,GAAG,CAAC,MAAM,KAAK,MAAM,EAAE,IAAI,CAAC,IAAI,YAAY,CAAC;QACvD;QAEA,QAAQ;QACR,YAAY,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,WAAW,GAAG;QACtD,YAAY,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,GAAG;QAElD,SAAS;QACT,QAAQ,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,OAAO,CAAC,IAAI,SAAS;IAC7D;IAEA,qBACE,8OAAC;QAAO,KAAK;;0BACX,8OAAC;gBAAe,KAAK;;;;;;0BACrB,8OAAC;gBACC,MAAM;gBACN,YAAY;gBACZ,WAAW;gBACX,UAAU,+IAAA,CAAA,mBAAsB;gBAChC,YAAY;;;;;;;;;;;;AAIpB;AAEA,QAAQ;AACR,SAAS,gBAAgB,EACvB,IAAI,EACJ,SAAS,EACT,SAAS,EACT,UAAU,EAMX;IACC,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAc;IACpC,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAc;IACpC,MAAM,UAAU,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAc;IAEnC,KAAK;IACL,CAAA,GAAA,+MAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,QAAQ;QAChB,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,QAAQ,OAAO,EAAE;QAEhE,SAAS;QACT,IAAI,MAAM;YACR,SAAS,OAAO,CAAC,KAAK,CAAC,GAAG,CACxB,IAAI,aAAa,KACjB,IAAI,aAAa,KACjB,IAAI,aAAa;QAErB,OAAO;YACL,UAAU;YACV,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,+IAAA,CAAA,YAAe,CAAC,IAAI,CAAC,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,QAAQ;YACrF,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,+IAAA,CAAA,YAAe,CAAC,IAAI,CAAC,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,QAAQ;YACrF,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,+IAAA,CAAA,YAAe,CAAC,IAAI,CAAC,SAAS,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,QAAQ;QACvF;QAEA,KAAK;QACL,SAAS,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,SAAS;QAC3D,SAAS,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,SAAS;QAE3D,SAAS,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,SAAS;QAC3D,SAAS,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,SAAS;QAE3D,QAAQ,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,UAAU;QAC3D,QAAQ,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,IAAI,UAAU;IAC7D;IAEA,qBACE,8OAAC;;0BACC,8OAAC,0JAAA,CAAA,cAAW;gBAAC,KAAK;gBAAU,MAAM;oBAAC;oBAAG;iBAAE;gBAAE,UAAU;oBAAC;oBAAG;oBAAG;iBAAE;0BAC3D,cAAA,8OAAC;oBACC,SAAS;oBACT,OAAM;;;;;;;;;;;0BAIV,8OAAC,0JAAA,CAAA,QAAK;gBAAC,KAAK;gBAAU,MAAM;oBAAC;oBAAG;oBAAK;oBAAI;iBAAG;gBAAE,UAAU;oBAAC;oBAAG;oBAAG;iBAAE;0BAC/D,cAAA,8OAAC;oBACC,SAAS;oBACT,OAAM;;;;;;;;;;;0BAIV,8OAAC,0JAAA,CAAA,YAAS;gBAAC,KAAK;gBAAS,MAAM;oBAAC;oBAAK;oBAAK;oBAAK;iBAAG;gBAAE,UAAU;oBAAC;oBAAG;oBAAG;iBAAE;0BACrE,cAAA,8OAAC;oBACC,SAAS;oBACT,OAAM;;;;;;;;;;;;;;;;;AAKhB;AAEA,OAAO;AACP,SAAS,MAAM,EAAE,YAAY,EAAuC;IAClE,sBAAsB;IACtB,MAAM,YAAY,gBAChB,OAAO,aAAa,SAAS,KAAK,YAClC,OAAO,aAAa,SAAS,KAAK,YAClC,OAAO,aAAa,UAAU,KAAK,YACnC,OAAO,aAAa,IAAI,KAAK,aAC7B,aAAa,aAAa,YAAY;IAExC,eAAe;IACf,MAAM,WAAW,YAAY,eAAe;QAC1C,WAAW;QACX,WAAW;QACX,YAAY;QACZ,MAAM;QACN,eAAe,IAAI,WAAW,MAAM,IAAI,CAAC;IAC3C;IAEA,qBACE;;0BACE,8OAAC;gBAAa,WAAW;;;;;;0BACzB,8OAAC;gBACC,OAAO;gBACP,WAAW,SAAS,SAAS;gBAC7B,WAAW,SAAS,SAAS;;;;;;0BAE/B,8OAAC;gBACC,MAAM,SAAS,IAAI;gBACnB,WAAW,SAAS,SAAS;gBAC7B,WAAW,SAAS,SAAS;gBAC7B,YAAY,SAAS,UAAU;;;;;;0BAEjC,8OAAC,iKAAA,CAAA,gBAAa;gBAAC,YAAY;gBAAO,WAAW;gBAAO,UAAU;gBAAC,iBAAiB;;;;;;;;AAGtF;AAGe,SAAS,iBAAiB,EAAE,YAAY,EAAuC;IAC5F,qBACE,8OAAC,mMAAA,CAAA,SAAM;QACL,WAAU;QACV,QAAQ;YAAE,UAAU;gBAAC;gBAAG;gBAAG;aAAG;YAAE,KAAK;QAAG;QACxC,OAAO;YACL,YAAY;QACd;kBAEA,cAAA,8OAAC;YAAM,cAAc;;;;;;;;;;;AAG3B","debugId":null}},
    {"offset": {"line": 1721, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/visualizers/themes/CyberpunkNeon.tsx"],"sourcesContent":["'use client';\n\nimport { useRef, useEffect } from 'react';\nimport { Canvas, useFrame, useThree } from '@react-three/fiber';\nimport { PerspectiveCamera, Line, Box, Torus } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { AudioAnalysisData } from '../../../hooks/useAudioAnalyzer';\n\n// 霓虹網格\nfunction NeonGrid({ \n  lowEnergy, \n  beat \n}: { \n  lowEnergy: number, \n  beat: boolean \n}) {\n  const linesRef = useRef<THREE.Group>(null);\n  const { size } = useThree();\n  \n  // 創建網格線\n  const gridSize = 20;\n  const gridDivisions = 20;\n  const stepSize = gridSize / gridDivisions;\n  \n  const horizontalLines = [];\n  const verticalLines = [];\n  \n  for (let i = 0; i <= gridDivisions; i++) {\n    const pos = -gridSize / 2 + i * stepSize;\n    \n    // 水平線\n    const hPoints = [];\n    hPoints.push(new THREE.Vector3(-gridSize / 2, 0, pos));\n    hPoints.push(new THREE.Vector3(gridSize / 2, 0, pos));\n    horizontalLines.push(hPoints);\n    \n    // 垂直線\n    const vPoints = [];\n    vPoints.push(new THREE.Vector3(pos, 0, -gridSize / 2));\n    vPoints.push(new THREE.Vector3(pos, 0, gridSize / 2));\n    verticalLines.push(vPoints);\n  }\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!linesRef.current) return;\n    \n    // 節拍時脈衝效果\n    if (beat) {\n      linesRef.current.scale.set(1.05, 1, 1.05);\n    } else {\n      linesRef.current.scale.x = THREE.MathUtils.lerp(linesRef.current.scale.x, 1, delta * 2);\n      linesRef.current.scale.z = THREE.MathUtils.lerp(linesRef.current.scale.z, 1, delta * 2);\n    }\n    \n    // 隨著低頻脈動\n    linesRef.current.position.y = -5 - lowEnergy * 2;\n  });\n  \n  return (\n    <group ref={linesRef} rotation={[Math.PI / 2, 0, 0]}>\n      {/* 水平線 */}\n      {horizontalLines.map((points, idx) => (\n        <Line\n          key={`h-${idx}`}\n          points={points}\n          color=\"#FF00FF\"\n          lineWidth={1}\n          transparent\n          opacity={0.6}\n        />\n      ))}\n      \n      {/* 垂直線 */}\n      {verticalLines.map((points, idx) => (\n        <Line\n          key={`v-${idx}`}\n          points={points}\n          color=\"#00FFFF\"\n          lineWidth={1}\n          transparent\n          opacity={0.6}\n        />\n      ))}\n    </group>\n  );\n}\n\n// 霓虹建築\nfunction NeonBuildings({\n  frequencyData,\n  highEnergy\n}: {\n  frequencyData: Uint8Array,\n  highEnergy: number\n}) {\n  const buildingsRef = useRef<THREE.Group>(null);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!buildingsRef.current) return;\n    \n    // 旋轉\n    buildingsRef.current.rotation.y += delta * 0.1;\n  });\n  \n  // 取樣頻譜數據\n  const sampleCount = 32;\n  const sampleData = [];\n  \n  for (let i = 0; i < sampleCount; i++) {\n    const index = Math.floor(i * (frequencyData.length / sampleCount));\n    const value = frequencyData[index] / 255;\n    sampleData.push(value);\n  }\n  \n  return (\n    <group ref={buildingsRef} position={[0, -5, 0]}>\n      {sampleData.map((value, idx) => {\n        const angle = (idx / sampleCount) * Math.PI * 2;\n        const radius = 10;\n        const x = Math.cos(angle) * radius;\n        const z = Math.sin(angle) * radius;\n        \n        // 建築高度由頻譜數據決定\n        const height = 0.5 + value * 8 + highEnergy * 3;\n        \n        // 交替顏色\n        const color = idx % 2 === 0 ? \"#FF00FF\" : \"#00FFFF\";\n        \n        return (\n          <Box \n            key={idx}\n            args={[0.8, height, 0.8]} \n            position={[x, height / 2, z]}\n          >\n            <meshBasicMaterial \n              color={color} \n              transparent \n              opacity={0.7}\n              wireframe={idx % 3 === 0}\n            />\n          </Box>\n        );\n      })}\n    </group>\n  );\n}\n\n// 霓虹光環\nfunction NeonHalos({ \n  midEnergy, \n  beat \n}: { \n  midEnergy: number, \n  beat: boolean \n}) {\n  const halosRef = useRef<THREE.Group>(null);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!halosRef.current) return;\n    \n    // 每個子元素旋轉\n    halosRef.current.children.forEach((child, idx) => {\n      const mesh = child as THREE.Mesh;\n      const rotSpeed = (idx + 1) * 0.1 * (1 + midEnergy);\n      \n      mesh.rotation.x += delta * rotSpeed;\n      mesh.rotation.y += delta * rotSpeed * 0.7;\n      \n      // 節拍反應\n      if (beat) {\n        mesh.scale.set(1.1, 1.1, 1.1);\n      } else {\n        mesh.scale.x = THREE.MathUtils.lerp(mesh.scale.x, 1, delta * 2);\n        mesh.scale.y = THREE.MathUtils.lerp(mesh.scale.y, 1, delta * 2);\n        mesh.scale.z = THREE.MathUtils.lerp(mesh.scale.z, 1, delta * 2);\n      }\n    });\n  });\n  \n  // 生成不同大小的環\n  const halos = [];\n  const count = 5;\n  \n  for (let i = 0; i < count; i++) {\n    const radius = 2 + i * 1.5;\n    const tubeRadius = 0.03 + i * 0.01;\n    \n    halos.push(\n      <Torus \n        key={i}\n        args={[radius, tubeRadius, 16, 100]}\n        rotation={[Math.random() * Math.PI, Math.random() * Math.PI, 0]}\n      >\n        <meshBasicMaterial \n          color={i % 2 === 0 ? \"#FF00FF\" : \"#00FFFF\"} \n          transparent\n          opacity={0.8}\n        />\n      </Torus>\n    );\n  }\n  \n  return (\n    <group ref={halosRef} position={[0, 0, 0]}>\n      {halos}\n    </group>\n  );\n}\n\n// 場景容器\nfunction Scene({ analysisData }: { analysisData: AudioAnalysisData }) {\n  const cameraRef = useRef<THREE.PerspectiveCamera>(null);\n  \n  // 相機動畫\n  useFrame((_state, delta) => {\n    if (!cameraRef.current) return;\n    \n    // 隨著中頻調整相機視角\n    cameraRef.current.position.y = 5 + analysisData.midEnergy * 3;\n    \n    // 緩慢晃動\n    cameraRef.current.position.x = Math.sin(Date.now() * 0.0005) * 2;\n    cameraRef.current.position.z = 15 + Math.sin(Date.now() * 0.0003) * 3;\n  });\n  \n  return (\n    <>\n      <PerspectiveCamera\n        ref={cameraRef}\n        makeDefault\n        position={[0, 5, 15]}\n        fov={60}\n      />\n      \n      <hemisphereLight args={[\"#FFFFFF\", \"#000000\", 1]} />\n      \n      <fog attach=\"fog\" args={[\"#000000\", 10, 50]} />\n      \n      <NeonGrid \n        lowEnergy={analysisData.lowEnergy}\n        beat={analysisData.beat}\n      />\n      \n      <NeonBuildings \n        frequencyData={analysisData.frequencyData}\n        highEnergy={analysisData.highEnergy}\n      />\n      \n      <NeonHalos \n        midEnergy={analysisData.midEnergy}\n        beat={analysisData.beat}\n      />\n    </>\n  );\n}\n\n// 賽博朋克霓虹可視化主題\nexport default function CyberpunkNeon({ analysisData }: { analysisData: AudioAnalysisData }) {\n  return (\n    <Canvas \n      className=\"w-full h-full\"\n      style={{\n        background: 'linear-gradient(to bottom, #000000 0%, #1a0033 100%)'\n      }}\n    >\n      <Scene analysisData={analysisData} />\n    </Canvas>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2050, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/visualizers/themes/RetroWave.tsx"],"sourcesContent":["'use client';\n\nimport { useRef } from 'react';\nimport { Canvas, useFrame } from '@react-three/fiber';\nimport { PerspectiveCamera, Grid, Box, Text } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { AudioAnalysisData } from '../../../hooks/useAudioAnalyzer';\n\n// 太陽效果\nfunction RetroSun({ beat, highEnergy }: { beat: boolean, highEnergy: number }) {\n  const sunRef = useRef<THREE.Mesh>(null);\n  \n  useFrame((_state, delta) => {\n    if (!sunRef.current) return;\n    \n    // 節拍時脈動\n    if (beat) {\n      sunRef.current.scale.set(1.1, 1.1, 1.1);\n    } else {\n      sunRef.current.scale.x = THREE.MathUtils.lerp(sunRef.current.scale.x, 1, delta * 2);\n      sunRef.current.scale.y = THREE.MathUtils.lerp(sunRef.current.scale.y, 1, delta * 2);\n      sunRef.current.scale.z = THREE.MathUtils.lerp(sunRef.current.scale.z, 1, delta * 2);\n    }\n  });\n  \n  return (\n    <mesh ref={sunRef} position={[0, 5, -30]}>\n      <circleGeometry args={[8, 64]} />\n      <meshBasicMaterial \n        color={new THREE.Color('#ff2975')} \n        transparent\n        opacity={0.9}\n      />\n    </mesh>\n  );\n}\n\n// 山脈效果\nfunction Mountains({ frequencyData }: { frequencyData: Uint8Array }) {\n  const mountainsRef = useRef<THREE.Group>(null);\n  \n  // 取樣頻譜數據\n  const sampleCount = 128;\n  const sampleData = [];\n  \n  for (let i = 0; i < sampleCount; i++) {\n    const index = Math.floor(i * (frequencyData.length / sampleCount));\n    const value = frequencyData[index] / 255;\n    sampleData.push(value);\n  }\n  \n  return (\n    <group ref={mountainsRef} position={[0, -1, -20]}>\n      {/* 遠處山脈 - 藍色 */}\n      <group position={[0, 0, -15]}>\n        {sampleData.slice(0, 64).map((value, idx) => {\n          const width = 0.8;\n          const x = (idx - 32) * width;\n          const height = value * 3 + 1;\n          \n          return (\n            <Box \n              key={`far-${idx}`}\n              args={[width, height, 0.1]} \n              position={[x, height / 2, 0]}\n            >\n              <meshBasicMaterial \n                color=\"#4361EE\" \n                transparent \n                opacity={0.9}\n              />\n            </Box>\n          );\n        })}\n      </group>\n      \n      {/* 中間山脈 - 紫色 */}\n      <group position={[0, 0, -5]}>\n        {sampleData.slice(64, 128).map((value, idx) => {\n          const width = 0.8;\n          const x = (idx - 32) * width;\n          const height = value * 5 + 0.5;\n          \n          return (\n            <Box \n              key={`mid-${idx}`}\n              args={[width, height, 0.1]} \n              position={[x, height / 2, 0]}\n            >\n              <meshBasicMaterial \n                color=\"#9f43ee\" \n                transparent \n                opacity={0.9}\n              />\n            </Box>\n          );\n        })}\n      </group>\n    </group>\n  );\n}\n\n// 網格地面\nfunction RetroPlatform({ lowEnergy }: { lowEnergy: number }) {\n  const platformRef = useRef<THREE.Group>(null);\n  \n  useFrame((_state, delta) => {\n    if (!platformRef.current) return;\n    \n    // 地面隨低頻上下移動\n    platformRef.current.position.y = -1.5 - lowEnergy * 1.5;\n  });\n  \n  return (\n    <group ref={platformRef}>\n      <Grid \n        position={[0, -0.01, 0]} \n        args={[50, 50]} \n        cellSize={1} \n        cellThickness={1} \n        cellColor=\"#ff2975\" \n        sectionSize={3} \n        sectionThickness={1.5} \n        sectionColor=\"#4CC9F0\" \n        fadeDistance={50} \n        infiniteGrid \n        fadeStrength={1} \n      />\n    </group>\n  );\n}\n\n// 復古文字\nfunction RetroText({ beat }: { beat: boolean }) {\n  const textRef = useRef<THREE.Group>(null);\n  \n  useFrame((_state, delta) => {\n    if (!textRef.current) return;\n    \n    // 節拍時閃爍\n    if (beat) {\n      textRef.current.visible = !textRef.current.visible;\n    }\n  });\n  \n  return (\n    <group ref={textRef} position={[0, 5, -20]}>\n      <Text\n        fontSize={3}\n        color=\"#ff2975\"\n        font=\"/fonts/VCR_OSD_MONO.ttf\"\n        anchorX=\"center\"\n        anchorY=\"middle\"\n      >\n        PULSE\n      </Text>\n    </group>\n  );\n}\n\n// 場景容器\nfunction Scene({ analysisData }: { analysisData: AudioAnalysisData }) {\n  const cameraRef = useRef<THREE.PerspectiveCamera>(null);\n  \n  useFrame((_state, delta) => {\n    if (!cameraRef.current) return;\n    \n    // 相機緩慢移動\n    cameraRef.current.position.y = 1 + Math.sin(Date.now() * 0.001) * 0.5;\n    cameraRef.current.position.x = Math.sin(Date.now() * 0.0003) * 2;\n  });\n  \n  return (\n    <>\n      <PerspectiveCamera\n        ref={cameraRef}\n        makeDefault\n        position={[0, 1, 5]}\n        fov={70}\n      />\n      \n      <color attach=\"background\" args={['#0d0221']} />\n      <fog attach=\"fog\" args={['#0d0221', 5, 50]} />\n      \n      <RetroSun \n        beat={analysisData.beat} \n        highEnergy={analysisData.highEnergy} \n      />\n      \n      <Mountains \n        frequencyData={analysisData.frequencyData} \n      />\n      \n      <RetroPlatform \n        lowEnergy={analysisData.lowEnergy} \n      />\n      \n      <RetroText \n        beat={analysisData.beat} \n      />\n    </>\n  );\n}\n\n// 復古波浪可視化主題\nexport default function RetroWave({ analysisData }: { analysisData: AudioAnalysisData }) {\n  return (\n    <Canvas className=\"w-full h-full\">\n      <Scene analysisData={analysisData} />\n    </Canvas>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2408, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/visualizers/themes/TechnoData.tsx"],"sourcesContent":["'use client';\n\nimport { useRef, useMemo } from 'react';\nimport { Canvas, useFrame } from '@react-three/fiber';\nimport { PerspectiveCamera, Line, Text, Environment } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { AudioAnalysisData } from '../../../hooks/useAudioAnalyzer';\n\n// 波形視覺化\nfunction Waveform({ \n  timeData, \n  color = '#00ff88',\n  position = [0, 0, 0],\n  scale = [1, 1, 1]\n}: { \n  timeData: Uint8Array,\n  color?: string,\n  position?: [number, number, number],\n  scale?: [number, number, number]\n}) {\n  const lineRef = useRef<THREE.Group>(null);\n  \n  // 創建波形線的點\n  const points = useMemo(() => {\n    const sampleCount = Math.min(timeData.length, 128);\n    const pts = [];\n    \n    for (let i = 0; i < sampleCount; i++) {\n      const x = (i / sampleCount) * 10 - 5;\n      // 歸一化數據到 -1 至 1\n      const y = ((timeData[i] / 255) * 2 - 1) * 0.5;\n      pts.push(new THREE.Vector3(x, y, 0));\n    }\n    \n    return pts;\n  }, [timeData]);\n  \n  return (\n    <group ref={lineRef} position={new THREE.Vector3(...position)} scale={scale}>\n      <Line\n        points={points}\n        color={color}\n        lineWidth={2}\n      />\n    </group>\n  );\n}\n\n// 頻譜視覺化\nfunction FrequencyBars({ \n  frequencyData,\n  midEnergy,\n  highEnergy,\n  position = [0, 0, 0],\n  height = 3,\n  width = 10,\n  barCount = 64\n}: { \n  frequencyData: Uint8Array,\n  midEnergy: number,\n  highEnergy: number,\n  position?: [number, number, number],\n  height?: number,\n  width?: number,\n  barCount?: number\n}) {\n  const barsRef = useRef<THREE.Group>(null);\n  \n  // 計算採樣間隔\n  const sampleStep = Math.floor(frequencyData.length / barCount);\n  \n  // 創建頻譜條\n  const bars = useMemo(() => {\n    const elements = [];\n    const barWidth = width / barCount;\n    \n    for (let i = 0; i < barCount; i++) {\n      const x = (i / barCount) * width - width / 2;\n      \n      // 採樣頻譜數據\n      const index = i * sampleStep;\n      const value = frequencyData[index] / 255;\n      \n      // 根據頻率位置選擇顏色\n      let color;\n      if (i < barCount * 0.33) {\n        color = new THREE.Color('#00ffaa');\n      } else if (i < barCount * 0.66) {\n        color = new THREE.Color('#00aaff');\n      } else {\n        color = new THREE.Color('#aa00ff');\n      }\n      \n      // 計算條高\n      const barHeight = value * height;\n      \n      elements.push(\n        <mesh key={i} position={[x, barHeight / 2, 0]}>\n          <boxGeometry args={[barWidth * 0.8, barHeight || 0.05, 0.1]} />\n          <meshBasicMaterial color={color} transparent opacity={0.8} />\n        </mesh>\n      );\n    }\n    \n    return elements;\n  }, [frequencyData, barCount, width, height, sampleStep]);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!barsRef.current) return;\n    \n    // 根據中高頻能量旋轉\n    barsRef.current.rotation.z = Math.sin(Date.now() * 0.001) * 0.1 * midEnergy;\n    barsRef.current.rotation.x = Math.sin(Date.now() * 0.0005) * 0.05 * highEnergy;\n  });\n  \n  return (\n    <group ref={barsRef} position={new THREE.Vector3(...position)}>\n      {bars}\n    </group>\n  );\n}\n\n// 資料圓環\nfunction DataCircle({ \n  frequencyData, \n  lowEnergy,\n  beat \n}: { \n  frequencyData: Uint8Array,\n  lowEnergy: number,\n  beat: boolean\n}) {\n  const circleRef = useRef<THREE.Group>(null);\n  \n  // 創建圓環上的數據點\n  const dataPoints = useMemo(() => {\n    const count = 128;\n    const points = [];\n    \n    for (let i = 0; i < count; i++) {\n      const angle = (i / count) * Math.PI * 2;\n      const sampledIndex = Math.floor(i * (frequencyData.length / count));\n      const value = frequencyData[sampledIndex] / 255;\n      \n      // 基本半徑加上頻譜數據\n      const radius = 4 + value * 1.5;\n      \n      const x = Math.cos(angle) * radius;\n      const y = Math.sin(angle) * radius;\n      \n      points.push(new THREE.Vector3(x, y, 0));\n    }\n    \n    // 閉合路徑\n    points.push(points[0].clone());\n    \n    return points;\n  }, [frequencyData]);\n  \n  // 動畫\n  useFrame((_state, delta) => {\n    if (!circleRef.current) return;\n    \n    // 旋轉\n    circleRef.current.rotation.z += delta * 0.1;\n    \n    // 節拍時脈衝\n    if (beat) {\n      circleRef.current.scale.set(1.05, 1.05, 1.05);\n    } else {\n      circleRef.current.scale.x = THREE.MathUtils.lerp(circleRef.current.scale.x, 1, delta * 3);\n      circleRef.current.scale.y = THREE.MathUtils.lerp(circleRef.current.scale.y, 1, delta * 3);\n      circleRef.current.scale.z = THREE.MathUtils.lerp(circleRef.current.scale.z, 1, delta * 3);\n    }\n  });\n  \n  return (\n    <group ref={circleRef}>\n      <Line\n        points={dataPoints}\n        color=\"#00ffaa\"\n        lineWidth={3}\n      />\n    </group>\n  );\n}\n\n// 資料指標\nfunction DataMetrics({ \n  analysisData,\n  position = [0, 4, 0] \n}: { \n  analysisData: AudioAnalysisData,\n  position?: [number, number, number]\n}) {\n  return (\n    <group position={new THREE.Vector3(...position)}>\n      <Text\n        position={[0, 0, 0]}\n        fontSize={0.3}\n        color=\"#00ffaa\"\n        anchorX=\"center\"\n        anchorY=\"middle\"\n      >\n        {`PULSE DATA ANALYZER`}\n      </Text>\n      \n      <Text\n        position={[-2, -0.5, 0]}\n        fontSize={0.25}\n        color=\"#00aaff\"\n        anchorX=\"left\"\n        anchorY=\"middle\"\n      >\n        {`VOLUME: ${(analysisData.volume * 100).toFixed(1)}%`}\n      </Text>\n      \n      <Text\n        position={[-2, -0.9, 0]}\n        fontSize={0.25}\n        color=\"#00aaff\"\n        anchorX=\"left\"\n        anchorY=\"middle\"\n      >\n        {`LOW: ${(analysisData.lowEnergy * 100).toFixed(1)}%`}\n      </Text>\n      \n      <Text\n        position={[-2, -1.3, 0]}\n        fontSize={0.25}\n        color=\"#00aaff\"\n        anchorX=\"left\"\n        anchorY=\"middle\"\n      >\n        {`MID: ${(analysisData.midEnergy * 100).toFixed(1)}%`}\n      </Text>\n      \n      <Text\n        position={[2, -0.9, 0]}\n        fontSize={0.25}\n        color=\"#00aaff\"\n        anchorX=\"right\"\n        anchorY=\"middle\"\n      >\n        {`HIGH: ${(analysisData.highEnergy * 100).toFixed(1)}%`}\n      </Text>\n      \n      <Text\n        position={[2, -1.3, 0]}\n        fontSize={0.25}\n        color=\"#00aaff\"\n        anchorX=\"right\"\n        anchorY=\"middle\"\n      >\n        {`BEAT: ${analysisData.beat ? 'ACTIVE' : 'IDLE'}`}\n      </Text>\n    </group>\n  );\n}\n\n// 場景容器\nfunction Scene({ analysisData }: { analysisData: AudioAnalysisData }) {\n  const cameraRef = useRef<THREE.PerspectiveCamera>(null);\n  \n  useFrame((_state, delta) => {\n    if (!cameraRef.current) return;\n    \n    // 相機平滑移動\n    const time = Date.now() * 0.0005;\n    cameraRef.current.position.x = Math.sin(time * 0.5) * 2;\n    cameraRef.current.position.y = 2 + Math.sin(time * 0.3) * 1;\n    cameraRef.current.position.z = 8 + Math.sin(time * 0.2) * 2;\n  });\n  \n  return (\n    <>\n      <PerspectiveCamera\n        ref={cameraRef}\n        makeDefault\n        position={[0, 2, 10]}\n        fov={60}\n      />\n      \n      <color attach=\"background\" args={['#041024']} />\n      <fog attach=\"fog\" args={['#041024', 5, 30]} />\n      <Environment preset=\"night\" />\n      \n      <DataCircle \n        frequencyData={analysisData.frequencyData}\n        lowEnergy={analysisData.lowEnergy}\n        beat={analysisData.beat}\n      />\n      \n      <FrequencyBars \n        frequencyData={analysisData.frequencyData}\n        midEnergy={analysisData.midEnergy}\n        highEnergy={analysisData.highEnergy}\n        position={[0, -2, 0]}\n        height={3}\n      />\n      \n      <Waveform \n        timeData={analysisData.timeData}\n        color=\"#00aaff\"\n        position={[0, 0, -1]}\n        scale={[1, 2, 1]}\n      />\n      \n      <DataMetrics \n        analysisData={analysisData}\n        position={[0, 4, 0]}\n      />\n    </>\n  );\n}\n\n// 科技數據可視化主題\nexport default function TechnoData({ analysisData }: { analysisData: AudioAnalysisData }) {\n  return (\n    <Canvas \n      className=\"w-full h-full\"\n      style={{\n        background: 'radial-gradient(circle at center, #042a38 0%, #041024 100%)'\n      }}\n    >\n      <Scene analysisData={analysisData} />\n    </Canvas>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2862, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/components/visualizers/VisualizerContainer.tsx"],"sourcesContent":["'use client';\n\nimport { useRef, useEffect } from 'react';\nimport { usePlayerStore } from '../../store/usePlayerStore';\nimport AbstractGeometry from './themes/AbstractGeometry';\nimport CyberpunkNeon from './themes/CyberpunkNeon';\nimport RetroWave from './themes/RetroWave';\nimport TechnoData from './themes/TechnoData';\n\nexport default function VisualizerContainer() {\n  const { currentTheme, analysisData } = usePlayerStore();\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // 渲染基於當前主題的可視化效果\n  const renderVisualizer = () => {\n    if (!analysisData) return null;\n\n    switch (currentTheme) {\n      case 'abstract-geometry':\n        return <AbstractGeometry analysisData={analysisData} />;\n      case 'cyberpunk-neon':\n        return <CyberpunkNeon analysisData={analysisData} />;\n      case 'retro-wave':\n        return <RetroWave analysisData={analysisData} />;\n      case 'techno-data':\n        return <TechnoData analysisData={analysisData} />;\n      default:\n        return <AbstractGeometry analysisData={analysisData} />;\n    }\n  };\n\n  return (\n    <div \n      ref={containerRef}\n      className=\"absolute inset-0 overflow-hidden z-0\"\n    >\n      {renderVisualizer()}\n    </div>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AASe,SAAS;IACtB,MAAM,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,iBAAc,AAAD;IACpD,MAAM,eAAe,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAE5C,iBAAiB;IACjB,MAAM,mBAAmB;QACvB,IAAI,CAAC,cAAc,OAAO;QAE1B,OAAQ;YACN,KAAK;gBACH,qBAAO,8OAAC,sKAAA,CAAA,UAAgB;oBAAC,cAAc;;;;;;YACzC,KAAK;gBACH,qBAAO,8OAAC,mKAAA,CAAA,UAAa;oBAAC,cAAc;;;;;;YACtC,KAAK;gBACH,qBAAO,8OAAC,+JAAA,CAAA,UAAS;oBAAC,cAAc;;;;;;YAClC,KAAK;gBACH,qBAAO,8OAAC,gKAAA,CAAA,UAAU;oBAAC,cAAc;;;;;;YACnC;gBACE,qBAAO,8OAAC,sKAAA,CAAA,UAAgB;oBAAC,cAAc;;;;;;QAC3C;IACF;IAEA,qBACE,8OAAC;QACC,KAAK;QACL,WAAU;kBAET;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 2945, "column": 0}, "map": {"version":3,"sources":["file:///Users/thomas/Desktop/pulse/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport AudioPlayer from './components/ui/AudioPlayer';\nimport ThemeSwitcher from './components/ui/ThemeSwitcher';\nimport VisualizerContainer from './components/visualizers/VisualizerContainer';\nimport { motion } from 'framer-motion';\n\nexport default function Home() {\n  const [showIntro, setShowIntro] = useState(true);\n  \n  // 自動隱藏介紹文字\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setShowIntro(false);\n    }, 5000);\n    \n    return () => clearTimeout(timer);\n  }, []);\n  \n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-between relative overflow-hidden\">\n      {/* 背景視覺化 */}\n      <div className=\"absolute inset-0 z-0\">\n        <VisualizerContainer />\n      </div>\n      \n      {/* 頂部標題 */}\n      <header className=\"relative z-10 w-full max-w-5xl flex items-center justify-between p-4 sm:p-8\">\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5 }}\n          className=\"text-white\"\n        >\n          <h1 className=\"text-2xl sm:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-500 to-blue-500\">\n            PULSE\n          </h1>\n          <p className=\"text-sm sm:text-base text-white/70\">\n            音樂可視化播放器\n          </p>\n        </motion.div>\n        \n        <motion.a\n          initial={{ opacity: 0, scale: 0.8 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ duration: 0.5, delay: 0.2 }}\n          href=\"https://github.com/yourusername/pulse\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"text-white hover:text-purple-300 transition\"\n        >\n          <svg \n            xmlns=\"http://www.w3.org/2000/svg\" \n            width=\"24\" \n            height=\"24\" \n            viewBox=\"0 0 24 24\" \n            fill=\"none\" \n            stroke=\"currentColor\" \n            strokeWidth=\"2\" \n            strokeLinecap=\"round\" \n            strokeLinejoin=\"round\"\n          >\n            <path d=\"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22\"></path>\n          </svg>\n        </motion.a>\n      </header>\n      \n      {/* 介紹文字 */}\n      {showIntro && (\n        <motion.div \n          className=\"absolute inset-0 flex items-center justify-center z-20\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 1 }}\n        >\n          <div className=\"bg-black/60 backdrop-blur-md p-6 sm:p-10 rounded-xl max-w-xl text-center\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold text-white mb-4\">\n              歡迎使用 PULSE\n            </h2>\n            <p className=\"text-gray-300 mb-6\">\n              上傳您喜愛的音樂，體驗動態視覺效果的饗宴。\n              選擇不同視覺主題，沉浸在音樂的視覺表現中。\n            </p>\n            <button \n              onClick={() => setShowIntro(false)}\n              className=\"px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg text-white font-medium hover:from-purple-700 hover:to-blue-700 transition\"\n            >\n              開始體驗\n            </button>\n          </div>\n        </motion.div>\n      )}\n      \n      {/* 主要內容區域 */}\n      <div className=\"relative z-10 flex flex-col sm:flex-row items-center sm:items-start justify-center gap-4 sm:gap-8 w-full max-w-7xl p-4 sm:p-8 mt-auto\">\n        {/* 主題切換器 */}\n        <motion.div \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ duration: 0.5, delay: 0.3 }}\n          className=\"w-full sm:w-64\"\n        >\n          <ThemeSwitcher />\n        </motion.div>\n        \n        {/* 播放控制區 */}\n        <motion.div \n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.1 }}\n          className=\"w-full\"\n        >\n          <AudioPlayer />\n        </motion.div>\n      </div>\n      \n      {/* 頁腳 */}\n      <footer className=\"relative z-10 w-full max-w-5xl p-4 sm:p-8 text-center text-white/60 text-sm\">\n        <p>\n          Created with 💜 &amp; Next.js, Three.js, WebGL &amp; Web Audio API | &copy; {new Date().getFullYear()} Pulse\n        </p>\n      </footer>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,WAAW;IACX,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,QAAQ,WAAW;YACvB,aAAa;QACf,GAAG;QAEH,OAAO,IAAM,aAAa;IAC5B,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAK,WAAU;;0BAEd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,+JAAA,CAAA,UAAmB;;;;;;;;;;0BAItB,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC,0LAAA,CAAA,SAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,SAAS;4BAAG,GAAG,CAAC;wBAAG;wBAC9B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,UAAU;wBAAI;wBAC5B,WAAU;;0CAEV,8OAAC;gCAAG,WAAU;0CAA4G;;;;;;0CAG1H,8OAAC;gCAAE,WAAU;0CAAqC;;;;;;;;;;;;kCAKpD,8OAAC,0LAAA,CAAA,SAAM,CAAC,CAAC;wBACP,SAAS;4BAAE,SAAS;4BAAG,OAAO;wBAAI;wBAClC,SAAS;4BAAE,SAAS;4BAAG,OAAO;wBAAE;wBAChC,YAAY;4BAAE,UAAU;4BAAK,OAAO;wBAAI;wBACxC,MAAK;wBACL,QAAO;wBACP,KAAI;wBACJ,WAAU;kCAEV,cAAA,8OAAC;4BACC,OAAM;4BACN,OAAM;4BACN,QAAO;4BACP,SAAQ;4BACR,MAAK;4BACL,QAAO;4BACP,aAAY;4BACZ,eAAc;4BACd,gBAAe;sCAEf,cAAA,8OAAC;gCAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;YAMb,2BACC,8OAAC,0LAAA,CAAA,SAAM,CAAC,GAAG;gBACT,WAAU;gBACV,SAAS;oBAAE,SAAS;gBAAE;gBACtB,SAAS;oBAAE,SAAS;gBAAE;gBACtB,MAAM;oBAAE,SAAS;gBAAE;gBACnB,YAAY;oBAAE,UAAU;gBAAE;0BAE1B,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAiD;;;;;;sCAG/D,8OAAC;4BAAE,WAAU;sCAAqB;;;;;;sCAIlC,8OAAC;4BACC,SAAS,IAAM,aAAa;4BAC5B,WAAU;sCACX;;;;;;;;;;;;;;;;;0BAQP,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC,0LAAA,CAAA,SAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,SAAS;4BAAG,GAAG,CAAC;wBAAG;wBAC9B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,UAAU;4BAAK,OAAO;wBAAI;wBACxC,WAAU;kCAEV,cAAA,8OAAC,gJAAA,CAAA,UAAa;;;;;;;;;;kCAIhB,8OAAC,0LAAA,CAAA,SAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC7B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,UAAU;4BAAK,OAAO;wBAAI;wBACxC,WAAU;kCAEV,cAAA,8OAAC,8IAAA,CAAA,UAAW;;;;;;;;;;;;;;;;0BAKhB,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;;wBAAE;wBAC4E,IAAI,OAAO,WAAW;wBAAG;;;;;;;;;;;;;;;;;;AAKhH","debugId":null}}]
}